<!DOCTYPE html>
<html manifest="manifest.mf">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=Utf-8">
    <script type="text/javascript" src="scripts/qrcode.js"></script>
    <script type="text/javascript" src="scripts/jquery-3.5.1.min.js"></script>
    <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.css">
    </link>
    <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.min.css">
    </link>
    <script src="bootstrap/js/bootstrap.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>

    <title>QR Code Generator for JavaScript</title>
</head>

<body>
    <div class="" style="display: flex; align-items: center; justify-content: center; min-height: 100vh;">
        <div class="row">
            <div class="col-md-12"
                style="min-height: 200px; border: 2px #007bff solid; border-radius: 5px; margin-bottom: 5px;">
                <div id="placeHolder" style="display: flex; align-items: center; justify-content: center;">

                </div>
            </div>
            <div class="col-md-12">
                <form>
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="name">First Name</label>
                            <input type="text" class="form-control" id="name" placeholder="">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="surname">Last Name</label>
                            <input type="text" class="form-control" id="surname" placeholder="">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="temp">Temperature</label>
                            <input type="number" class="form-control" id="temp" value="36.5" step="0.1">
                        </div>
                        <div class="form-group col-md-6">
                            <label for="visitDate">Visit Date</label>
                            <input type="date" class="form-control" id="visitDate" required>
                        </div>
                    </div>
                </form>
                <button class="btn btn-primary" onclick='makeQRCode();'> Generate QR Code</button>
            </div>
        </div>
    </div>
</body>
<script>
    window.onload = function () {
        let json = localStorage.getItem("json");

        json = JSON.parse(json);
        if (json) {
            $('#name').val(json.name);
            $('#surname').val(json.surname);
            $('#temp').val(json.temp);
            $('#visitDate').val(json.visitDate);
        }
        var d = new Date();
        var month = d.getMonth();
        var month_actual = month + 1;

        if (month_actual < 10) {
            month_actual = "0" + month_actual;
        }

        var day_val = d.getDate();
        if (day_val < 10) {
            day_val = "0" + day_val;
        }

        let str = d.getFullYear() + "-" + month_actual + "-" + day_val;
        $('#visitDate').val(str);
    }

    function makeQRCode() {
        var typeNumber = 0;
        var errorCorrectionLevel = 'L';
        var qr = qrcode(typeNumber, errorCorrectionLevel);

        var name = $('#name').val();
        var surname = $('#surname').val();
        var temp = $('#temp').val();
        var visitDate = $('#visitDate').val();

        var json = {
            'name': name,
            'surname': surname,
            'temp': temp,
            'visitDate': visitDate
        }

        json = JSON.stringify(json);
        visitDate = visitDate.replace(/-/gi, '/')

        var str = name + "|" + surname + "|" + temp + "|" + visitDate;

        localStorage.setItem("json", json);

        qr.addData(str);
        qr.make();
        document.getElementById('placeHolder').innerHTML = qr.createImgTag();
    }
</script>

</html>